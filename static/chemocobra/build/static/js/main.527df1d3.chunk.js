(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),c=n(12),r=n.n(c),o=(n(81),n(47)),s=n(7),l=n.n(s),u=n(13),d=n(65),h=n(14),f=n(15),b=n(17),m=n(16),p=n(18),v=(n(84),i.a.createContext({})),S=(n(85),n(86),n(64)),g=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(b.a)(this,Object(m.a)(t).call(this,e))).state={editingReactionId:""},n.inputRefUpperBound=i.a.createRef(),n.inputRefLowerBound=i.a.createRef(),n}return Object(p.a)(t,e),Object(f.a)(t,[{key:"setEditingReaction",value:function(e){this.setState({editingReactionId:e.id})}},{key:"saveEditingReaction",value:function(e){var t=this.inputRefLowerBound.current.value,n=this.inputRefUpperBound.current.value;isNaN(t)||isNaN(n)||(t=Number(t),n=Number(n),t!==e.lower_bound||n!==e.upper_bound?this.context.addModifReactionToScen(this.context.selScenId,e.id,t,n):e.id in this.context.getSelScen().modifReacts&&this.context.removeModifReactionToScen(this.context.selScenId,e.id)),this.setState({editingReactionId:""})}},{key:"cellFunctionLowerLimit",value:function(e){return e.original.id===this.state.editingReactionId?i.a.createElement("input",{type:"text",ref:this.inputRefLowerBound,defaultValue:e.original.lower_bound}):e.original.id in this.props.tableScen.modifReacts?i.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},this.props.tableScen.modifReacts[e.original.id][0]):e.original.lower_bound}},{key:"cellFunctionUpperLimit",value:function(e){return e.original.id===this.state.editingReactionId?i.a.createElement("input",{type:"text",ref:this.inputRefUpperBound,defaultValue:e.original.upper_bound}):e.original.id in this.props.tableScen.modifReacts?i.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},this.props.tableScen.modifReacts[e.original.id][1]):e.original.upper_bound}},{key:"cellFunctionEditLimits",value:function(e){return this.context.getSelScen()===this.props.tableScen?e.original.id===this.state.editingReactionId?i.a.createElement("div",{id:"save-button",onClick:this.saveEditingReaction.bind(this,e.original)}," Save"):i.a.createElement("div",{id:"edit-button",onClick:this.setEditingReaction.bind(this,e.original),style:{cursor:"pointer"}}," Edit"):""}},{key:"render",value:function(){var e=[{Header:this.context.createNewScen?"Save Scenario to modify flux limits":"Explore and edit reaction flux limits",columns:[{Header:"ID",accessor:"id",width:80,style:{fontWeight:"bold"}},{Header:"Name",accessor:"name"},{Header:"Reaction",accessor:"reactionString"},{Header:"Genes",accessor:"gene_reaction_rule"}]},{Header:"Limits",columns:[{Header:"Lower",Cell:this.cellFunctionLowerLimit.bind(this),width:50,filterable:!1,sortable:!1},{Header:"Upper",Cell:this.cellFunctionUpperLimit.bind(this),width:50,filterable:!1,sortable:!1},{Header:"Edit",Cell:this.cellFunctionEditLimits.bind(this),filterable:!1,sortable:!1,width:50}]}],t=[],n=this.props.tableScen.baseModelId;return""!==n&&this.context.getModel(n)&&(t=this.context.getModel(this.props.tableScen.baseModelId).reactions),i.a.createElement(S.a,{className:"-striped -highlight",data:t,columns:e,filterable:!0,defaultPageSize:10,pageSizeOptions:[10,15,20],noDataText:"Please Choose a Model Above",defaultFilterMethod:function(e,t,n){var a=e.pivotId||e.id;return void 0!==t[a]&&String(t[a]).toLowerCase().includes(e.value.toLowerCase())}})}}]),t}(a.Component);g.contextType=v;var y=n(142),M=n(146),E=n(139),x=n(147),w=n(144),j=n(145),O=n(143),I=n(140),k=n(63),R=n.n(k),C=n(62),N=n.n(C),B=n(61),_=n.n(B),F=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(b.a)(this,Object(m.a)(t).call(this,e))).state={newScenId:"",newScenBaseModelId:"",newScenObjectiveReaction:null,editingScen:null},n}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(t.newScenBaseModelId!==this.state.newScenBaseModelId&&this.setState({newScenObjectiveReaction:null}),null===this.state.newScenObjectiveReaction&&""!==this.state.newScenBaseModelId){var n=this.context.getModel(this.state.newScenBaseModelId);n&&this.setState({newScenObjectiveReaction:this.context.getObjectiveReaction(n)})}if(this.context.createNewScen&&null!==this.state.editingScen)this.setState({editingScen:null});else if(!this.context.createNewScen&&(null===this.state.editingScen||this.state.editingScen.id!==this.context.selScenId)){var a=this.context.getScen(this.context.selScenId);this.setState({editingScen:a,newScenId:a.id,newScenBaseModelId:a.baseModelId,newScenObjectiveReaction:this.context.getObjectiveReactionScen(a)})}}},{key:"handleChangeScenId",value:function(e){this.setState({newScenId:e.target.value})}},{key:"handleChangeBaseModelId",value:function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({newScenBaseModelId:t.target.value}),""!==t.target.value&&this.context.loadModel(t.target.value);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSaveButton",value:function(){var e={id:this.state.newScenId,modifReacts:[],objective:this.state.newScenObjectiveReaction.id,baseModelId:this.state.newScenBaseModelId,baseModelName:this.context.allModelIds[this.state.newScenBaseModelId]};this.context.addScen(e),this.context.setSelScenId(this.state.newScenId),this.context.setCreateNewScen(!1)}},{key:"handleAddScenario",value:function(){this.setState({newScenId:"",newScenBaseModelId:"",newScenObjectiveReaction:null}),this.context.setCreateNewScen(!0)}},{key:"handleClearButton",value:function(){this.context.removeScen(this.context.getSelScen()),this.context.setCreateNewScen(!0),this.setState({newScenId:"",newScenBaseModelId:"",newScenObjectiveReaction:null,editingScen:null})}},{key:"render",value:function(){var e=this,t={};t=this.context.createNewScen?{id:this.state.newScenId,baseModelId:this.state.newScenBaseModelId,objectiveId:this.state.newScenObjectiveId,modifReacts:[]}:this.context.getSelScen();var n=null,a=this.context.getModel(this.state.newScenBaseModelId);""!==this.state.newScenObjectiveId&&a&&(n=i.a.createElement(O.a,{id:"objective-reaction",options:a.reactions,getOptionLabel:function(e){return"".concat(e.id,": ").concat(e.name)},renderInput:function(e){return i.a.createElement(y.a,Object.assign({},e,{label:"Objective Function",variant:"outlined",fullWidth:!0}))},value:this.state.newScenObjectiveReaction,onChange:function(t,n){return e.setState({newScenObjectiveReaction:n})},style:{minWidth:400},disabled:!this.context.createNewScen,disableClearable:!0}));var c=i.a.createElement("form",null,i.a.createElement(j.a,{disabled:!this.context.createNewScen},i.a.createElement(E.a,{component:"legend"},"Please Choose a Model"),i.a.createElement(M.a,{value:this.state.newScenBaseModelId,onChange:this.handleChangeBaseModelId.bind(this)},Object.keys(this.context.allModelIds).map(function(t){return i.a.createElement(x.a,{value:t,control:i.a.createElement(w.a,null),label:"".concat(t," - ").concat(e.context.allModelIds[t]),key:t})}))),i.a.createElement(y.a,{variant:"outlined",id:"scenario-name",label:"  Scenario Name / Id",value:this.state.newScenId,onChange:this.handleChangeScenId.bind(this),style:{minWidth:400},disabled:!this.context.createNewScen}),n),r=i.a.createElement("div",{id:"title"},this.context.createNewScen?"Create new scenario ".concat(this.state.newScenId):"Edit Scenario: ".concat(this.context.selScenId)),o=this.context.createNewScen?i.a.createElement(I.a,{variant:"contained",color:"primary",id:"save-button",disabled:0===this.state.newScenId.length||0===this.state.newScenBaseModelId.length,onClick:this.handleSaveButton.bind(this),startIcon:i.a.createElement(_.a,null)},"Save"):null,s=this.context.createNewScen?null:i.a.createElement(I.a,{variant:"contained",color:"secondary",id:"clear-button",startIcon:i.a.createElement(N.a,null),onClick:this.handleClearButton.bind(this)},"Delete");return i.a.createElement("div",{id:"ModelDescription"},i.a.createElement("div",{className:"first-line"},r,i.a.createElement("div",{id:"add-scenario",onClick:this.handleAddScenario.bind(this)},i.a.createElement(R.a,{fontSize:"large"}),"Add Scenario")),c,i.a.createElement("div",{id:"buttons"},o,s),i.a.createElement("div",{id:"model-table"},i.a.createElement(g,{tableScen:t})))}}]),t}(a.Component);F.contextType=v;var A=F,T=(n(91),n(92),function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(f.a)(t,[{key:"handleClick",value:function(){this.context.selScenId!==this.props.scen.id&&(this.context.setSelScenId(this.props.scen.id),this.context.setCreateNewScen(!1))}},{key:"render",value:function(){var e=this,t=Object.keys(this.props.scen.modifReacts).map(function(t){return i.a.createElement("div",{key:t,className:"modif-reaction"},i.a.createElement("strong",null,t)," : ",e.props.scen.modifReacts[t][0]," / ",e.props.scen.modifReacts[t][1])});return i.a.createElement("div",{id:"ScenElement",className:this.context.selScenId===this.props.scen.id?"selected":null,onClick:this.handleClick.bind(this)},i.a.createElement("div",{id:"scen-element-title"},this.props.scen.id),i.a.createElement("div",{id:"scen-element-model"},i.a.createElement("span",{style:{fontWeight:"bold"}},"Model Id:")," ",this.props.scen.baseModelId),i.a.createElement("div",{id:"scen-element-organism"},i.a.createElement("span",{style:{fontWeight:"bold"}},"Organism:")," ",this.props.scen.baseModelName),i.a.createElement("div",{id:"scen-element-objective"},i.a.createElement("span",{style:{fontWeight:"bold"}},"Objective:")," ",this.props.scen.objective),i.a.createElement("div",{id:"scen-element-reactions"},i.a.createElement("span",{style:{fontWeight:"bold"}},"Modified Reactions:")),t)}}]),t}(a.Component));T.contextType=v;var L=T,W=function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.context.allScens.map(function(e){return i.a.createElement(L,{key:e.id,scen:e})});return i.a.createElement("div",{id:"ScenOptions"},i.a.createElement("div",{id:"scen-options-title"},"List Scenarios"),i.a.createElement("div",{id:"scen-options-elements"},e))}}]),t}(a.Component);W.contextType=v;var V=W,D=(n(93),function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e;return e="options"===this.context.page?"Run Model":"Options",i.a.createElement("div",{id:"Navbar"},i.a.createElement("div",{id:"Navbar-switch-button"},i.a.createElement("button",{onClick:this.context.switchMainPage,disabled:0===this.context.allScens.length},e)),i.a.createElement("div",{id:"Navbar-title"},"Metabolic Modelling"),i.a.createElement("div",{id:"Navbar-empty"}))}}]),t}(a.Component));D.contextType=v;var H=D,P=(n(94),"/chemocobra/");function U(e,t,n,a){return z.apply(this,arguments)}function z(){return(z=Object(u.a)(l.a.mark(function e(t,n,a,i){var c,r,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.map(function(e){return fetch(P+"metabolic/run_fva/?".concat(Q(e),"&reactId=").concat(t,"&fractionOpt=").concat(i)).then(function(e){return e.json()}).catch(function(e){return console.log(e)})}),e.next=3,Promise.all(c);case 3:return r=e.sent,o=r.map(function(e,i){return{scen:n[i].id,min:(e.min||0).toFixed(3),pFBA:(a[n[i].id][t]||0).toFixed(3),max:(e.max||0).toFixed(3)}}),e.abrupt("return",o);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function G(){return J.apply(this,arguments)}function J(){return(J=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(P+"metabolic/see_available_models").then(function(e){return e.json()}).catch(function(e){return console.log(e)});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function q(){return X.apply(this,arguments)}function X(){return(X=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(P+"metabolic/see_available_maps").then(function(e){return e.json()}).catch(function(e){return console.log(e)});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $(e){return K.apply(this,arguments)}function K(){return(K=Object(u.a)(l.a.mark(function e(t){var n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=P+"metabolic/run_pfba/?".concat(Q(t)),e.next=3,fetch(n).then(function(e){return e.json()});case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Q(e){var t="baseModelId=".concat(e.baseModelId,"&objective=").concat(e.objective);if(Object.keys(e.modifReacts).length>0){var n=Object.keys(e.modifReacts).map(function(t){return t+"/"+e.modifReacts[t].join("/")}).join(",");t+="&modifReacts=".concat(n)}return t}function Y(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(P+"metabolic/get_map/?id=".concat(t)).then(function(e){return e.json()}).catch(function(e){return console.log(e)});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return(te=Object(u.a)(l.a.mark(function e(t){var n,a,i=arguments;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],e.next=3,fetch(P+"metabolic/get_model/?id=".concat(t)).then(function(e){return e.json()}).then(function(e){if(n){var t=[],a=!0,i=!1,c=void 0;try{for(var r,o=e.reactions[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var s=r.value;s.reactionString=ne(s),t.push(s)}}catch(l){i=!0,c=l}finally{try{a||null==o.return||o.return()}finally{if(i)throw c}}e.reactions=t}return e});case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ne(e){var t=[],n=[],a="";for(var i in e.metabolites)1===e.metabolites[i]?n.push(i):e.metabolites[i]>0?n.push(e.metabolites[i]+"*"+i):-1===e.metabolites[i]?t.push(i):t.push(-1*e.metabolites[i]+"*"+i);return a=e.lower_bound<0&&e.upper_bound>0?"<==>":e.lower_bound>=0&&e.upper_bound>0?"--\x3e":e.lower_bound<0&&e.upper_bound<=0?"<--":"=!=","".concat(t.join(" + ")," ").concat(a," ").concat(n.join(" + "))}var ae=n(45),ie=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(b.a)(this,Object(m.a)(t).call(this,e))).state={fractOptimum:.9,correctFractOpt:!0,inputfractOptimum:"0.9",dataFVA:{},tab:"info",selReaction:{}},n}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.context.getSelScen(),n=this.context.getModel(t.baseModelId),this.setState({selReaction:n.reactions.filter(function(e){return e.id===t.objective})[0]}),this.runFVA(t.objective);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"runFVA",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t,this.context.allScens,this.context.respfba,1);case 2:n=e.sent,this.setState({dataFVA:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"validateFractOpt",value:function(e){this.setState({inputfractOptimum:e.target.value});var t=!isNaN(e.target.value);if(t){var n=Number(e.target.value);(t=t&&n>0&&n<=1)&&this.setState({fractOptimum:n})}this.setState({correctFractOpt:t})}},{key:"handleReactionChange",value:function(e,t){console.log("handleReactionChange",t),this.setState({selReaction:t,dataFVA:{}}),this.runFVA(t.id)}},{key:"handleChangeTab",value:function(e){this.setState({tab:e.target.value})}},{key:"render",value:function(){["None"].concat(this.context.getReactionsIds()).map(function(e){return i.a.createElement("option",{key:e},e)});var e,t=this.state.selReaction;return console.log("reaction",t),"info"===this.state.tab?e=i.a.createElement("div",{id:"reaction-infos-table"},i.a.createElement("table",null,i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Name:"),i.a.createElement("td",null,t.name)),i.a.createElement("tr",null,i.a.createElement("th",null,"Bounds:"),i.a.createElement("td",null,t.lower_bound," / ",t.upper_bound)),i.a.createElement("tr",null,i.a.createElement("th",null,"Genes:"),i.a.createElement("td",null,t.gene_reaction_rule)),i.a.createElement("tr",null,i.a.createElement("th",null,"Reaction:"),i.a.createElement("td",null,t.reactionString))))):"FVA"===this.state.tab&&(e=i.a.createElement("div",{id:"reaction-json-table"},i.a.createElement(ae.JsonToTable,{json:this.state.dataFVA,id:"reaction-json-table"}))),i.a.createElement("div",{id:"ReactionResults"},i.a.createElement("div",{id:"reaction-results-title"},"Reactions Analysis"),i.a.createElement("div",{id:"reaction-results-form"},i.a.createElement(O.a,{id:"reaction-analysis",options:this.context.getReactions(),getOptionLabel:function(e){return"".concat(e.id,": ").concat(e.name)},renderInput:function(e){return i.a.createElement(y.a,Object.assign({},e,{label:"Reaction",variant:"outlined",fullWidth:!0}))},value:this.state.selReaction,onChange:this.handleReactionChange.bind(this),style:{minWidth:350},disableClearable:!0})),i.a.createElement("div",{id:"reaction-results-radio",onChange:this.handleChangeTab.bind(this)},i.a.createElement("input",{type:"radio",value:"info",name:"radio",defaultChecked:!0})," Infos",i.a.createElement("input",{type:"radio",value:"FVA",name:"radio"})," FVA"),i.a.createElement("div",{id:"reaction-results-infos"},e))}}]),t}(a.Component);ie.contextType=v;n(99);var ce=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(b.a)(this,Object(m.a)(t).call(this,e))).state={tab:"info",structSVG:"",selMetabolite:{}},n}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.context.getSelScen(),n=this.context.getModel(t.baseModelId),this.setState({selMetabolite:n.metabolites[0]});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(u.a)(l.a.mark(function e(t,n){var a,i;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.selMetabolite.id!==n.selMetabolite.id)||this.state.selMetaboliteId==={}){e.next=11;break}if(a="/chemocobra/chemo/get_svg_metabolite/".concat(this.state.selMetabolite.id),0!==Object.keys(this.state.selMetabolite).length){e.next=7;break}i="",e.next=10;break;case 7:return e.next=9,fetch(a).then(function(e){return e.text()});case 9:i=e.sent;case 10:this.setState({structSVG:i});case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleChangeTab",value:function(e){this.setState({tab:e.target.value})}},{key:"handleMetaboliteChange",value:function(e,t){this.setState({selMetabolite:t})}},{key:"render",value:function(){var e,t=this;if("info"===this.state.tab)e=i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"metabolite-infos-table"},i.a.createElement("table",null,i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Name:"),i.a.createElement("td",null,this.state.selMetabolite.name)),i.a.createElement("tr",null,i.a.createElement("th",null,"Formula:"),i.a.createElement("td",null,this.state.selMetabolite.formula)),i.a.createElement("tr",null,i.a.createElement("th",null,"Structure:"),i.a.createElement("td",{onClick:function(e){return t.handleClickMNX(t.state.selMetabolite.MNX)}},this.state.selMetabolite.MNX))))),i.a.createElement("div",{id:"metabolite-structure",dangerouslySetInnerHTML:{__html:this.state.structSVG}}));else if("balance"===this.state.tab){var n={};this.state.selMetabolite.id&&(n=this.context.getMetaboliteBalance(this.state.selMetabolite.id,0)),e=n.length>0?i.a.createElement(ae.JsonToTable,{json:n,key:"json-table",id:"metabolite-json-table"}):i.a.createElement("div",null,"No flux regarding this metabolite")}return i.a.createElement("div",{id:"MetaboliteResults"},i.a.createElement("div",{id:"metabolite-results-title"},"Metabolite Analysis"),i.a.createElement("div",{id:"metabolite-results-form"},i.a.createElement(O.a,{id:"metabolite-analysis",options:this.context.getMetabolites(),getOptionLabel:function(e){return"".concat(e.id,": ").concat(e.name)},renderInput:function(e){return i.a.createElement(y.a,Object.assign({},e,{label:"Metabolite",variant:"outlined",fullWidth:!0}))},value:this.state.selMetabolite,onChange:this.handleMetaboliteChange.bind(this),style:{minWidth:350},disableClearable:!0})),i.a.createElement("div",{id:"metabolite-results-radio",onChange:this.handleChangeTab.bind(this)},i.a.createElement("input",{type:"radio",value:"info",name:"metabolite-radio",defaultChecked:!0})," Infos",i.a.createElement("input",{type:"radio",value:"balance",name:"metabolite-radio"})," Balance"),i.a.createElement("div",{id:"metabolite-results-content"},e))}}]),t}(a.Component);ce.contextType=v;n(100);var re=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(b.a)(this,Object(m.a)(t).call(this,e))).state={selMapId:"None",selMap:null},n.escherBuilder=null,n}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.loadEscher(this.context.getModel(this.context.getSelScen().baseModelId)),this.changeMapEscher(this.context.getSelScen(),this.context.getModel(this.context.getSelScen().baseModelId),this.context.respfba,this.state.selMap)}},{key:"componentDidUpdate",value:function(){this.changeMapEscher(this.context.getSelScen(),this.context.getModel(this.context.getSelScen().baseModelId),this.context.respfba,this.state.selMap)}},{key:"changeMapEscher",value:function(e,t,n,a){var i={},c=!0,r=!1,o=void 0;try{for(var s,l=t.reactions[Symbol.iterator]();!(c=(s=l.next()).done);c=!0){var u=s.value;u.id in n[e.id]?i[u.id]=n[e.id][u.id]:i[u.id]=0}}catch(d){r=!0,o=d}finally{try{c||null==l.return||l.return()}finally{if(r)throw o}}a&&(this.escherBuilder.load_map(a),this.escherBuilder.set_reaction_data(i))}},{key:"loadEscher",value:function(e){document.querySelector("#metabolic-map-escher")&&(this.escherBuilder=window.escher.Builder(null,e,null,document.querySelector("#metabolic-map-escher"),{never_ask_before_quit:!0,reaction_scale:[{type:"min",color:"#c8c8c8",size:12},{type:"max",color:"#66176d",size:20}],enable_keys:!1,enable_search:!1}))}},{key:"clearEscher",value:function(){this.escherBuilder=null}},{key:"handleMapChange",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.value,a={},"None"===n){e.next=8;break}return e.next=5,Y(n);case 5:a=e.sent,e.next=9;break;case 8:a=null;case 9:this.setState({selMapId:n,selMap:a});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleScenChange",value:function(e){var t=this.context.getScen(e.target.value);this.context.setSelScenId(t.id)}},{key:"getMapsSelScen",value:function(){var e=this;return this.context.allMapIds.filter(function(t){return t.indexOf(e.context.getSelScen().baseModelId.split("_")[0])>=0})}},{key:"render",value:function(){var e=[i.a.createElement("option",{key:"None",value:"None"},"No map")];e.push(this.getMapsSelScen().map(function(e){return i.a.createElement("option",{key:e},e)}));var t=this.context.allScens.map(function(e){return i.a.createElement("option",{key:e.id},e.id)});return i.a.createElement("div",{id:"MetabolicMap"},i.a.createElement("div",{id:"metabolic-map-form"},i.a.createElement("label",null,"Choose Scenario:",i.a.createElement("select",{value:this.context.selScenId,onChange:this.handleScenChange.bind(this)},t)),i.a.createElement("label",null,"Please select a map:",i.a.createElement("select",{onChange:this.handleMapChange.bind(this)},e))),i.a.createElement("div",{id:"metabolic-map-escher"},"Metabolic Map"))}}]),t}(a.Component);re.contextType=v;var oe=n(141),se=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(b.a)(this,Object(m.a)(t).call(this,e))).setSelScenId=function(e){n.setState({selScenId:e})},n.setCreateNewScen=function(e){return n.setState({createNewScen:e})},n.getSelScen=function(){return""!==n.state.selScenId?n.state.allScens.filter(function(e){return e.id===n.state.selScenId})[0]:{}},n.addScen=function(e){n.setState(function(t){var n=t.allScens.map(function(e){return e.id}).indexOf(e.id);if(console.log(e,n),-1===n)return{allScens:t.allScens.concat([e])};var a=Object(d.a)(t.allScens);return a[n]=e,{allScens:a}})},n.removeScen=function(e){n.setState(function(t){return{allScens:t.allScens.filter(function(t){return t.id!==e.id})}})},n.state={allModelIds:{},allMapIds:[],allScens:[],selScenId:"",page:"options",createNewScen:!0,allModels:[],respfba:{}},n}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:return t=e.sent,e.next=5,q();case 5:n=e.sent,this.setState({allModelIds:t,allMapIds:n});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getObjectiveReactionScen",value:function(e){return this.getModel(e.baseModelId).reactions.filter(function(t){return t.id===e.objective})[0]}},{key:"getObjectiveReaction",value:function(e){return e.reactions.filter(function(e){return"objective_coefficient"in e&&0!==e.objective_function})[0]}},{key:"getMetaboliteBalance",value:function(e,t){var n=this,a={},i={},c=!0,r=!1,o=void 0;try{for(var s,l=function(){var t=s.value;i[t.id]={},n.getModel(t.baseModelId).reactions.forEach(function(c){if(e in c.metabolites&&c.id in n.state.respfba[t.id]){var r=c.metabolites[e]*n.state.respfba[t.id][c.id];i[t.id][c.id]=+r.toFixed(2),c.id in a?a[c.id]+=Math.abs(i[t.id][c.id]):a[c.id]=Math.abs(i[t.id][c.id])}})},u=this.state.allScens[Symbol.iterator]();!(c=(s=u.next()).done);c=!0)l()}catch(d){r=!0,o=d}finally{try{c||null==u.return||u.return()}finally{if(r)throw o}}return Object.keys(a).sort(function(e,t){return a[t]-a[e]}).filter(function(e){return a[e]>=t}).map(function(e){var t={reaction:e.length<20?e:e.slice(0,20)+"..."},a=!0,c=!1,r=void 0;try{for(var o,s=n.state.allScens[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;e in i[l.id]?t[l.id]=i[l.id][e]:t[l.id]=0}}catch(d){c=!0,r=d}finally{try{a||null==s.return||s.return()}finally{if(c)throw r}}return t})}},{key:"getMetaboliteIds",value:function(){var e=this,t=this.state.allScens.map(function(e){return e.baseModelId});t=Array.from(new Set(t));var n=[];return t.forEach(function(t){var a=e.getModel(t).metabolites.map(function(e){return e.id});n=n.concat(a)}),(n=Array.from(new Set(n))).sort(),n}},{key:"getMetabolites",value:function(){var e=this,t=this.state.allScens.map(function(e){return e.baseModelId});t=Array.from(new Set(t));var n=[];return t.forEach(function(t){var a=e.getModel(t),i=n.map(function(e){return e.id}),c=a.metabolites.filter(function(e){return-1===i.indexOf(e.id)});n=n.concat(c)}),n.sort(function(e,t){return e.id.localeCompare(t.id)}),n}},{key:"getMetaboliteFromId",value:function(e){var t=this,n=this.state.allScens.map(function(e){return e.baseModelId});n=Array.from(new Set(n));var a={};return n.forEach(function(n){var i=t.getModel(n).metabolites.filter(function(t){return t.id===e});i.length>0&&(a=i[0])}),a}},{key:"getReactionFromId",value:function(e){var t=this,n=this.state.allScens.map(function(e){return e.baseModelId});n=Array.from(new Set(n));var a={};return n.forEach(function(n){var i=t.getModel(n).reactions.filter(function(t){return t.id===e});i.length>0&&(a=i[0])}),a}},{key:"getReactionsIds",value:function(){var e=this,t=this.state.allScens.map(function(e){return e.baseModelId});t=Array.from(new Set(t));var n=[];return t.forEach(function(t){var a=e.getModel(t).reactions.map(function(e){return e.id});n=n.concat(a)}),(n=Array.from(new Set(n))).sort(),n}},{key:"getReactions",value:function(){var e=this,t=this.state.allScens.map(function(e){return e.baseModelId});t=Array.from(new Set(t));var n=[];return t.forEach(function(t){var a=e.getModel(t),i=n.map(function(e){return e.id}),c=a.reactions.filter(function(e){return-1===i.indexOf(e.id)});n=n.concat(c)}),n.sort(function(e,t){return e.id.localeCompare(t.id)}),n}},{key:"addModifReactionToScen",value:function(e,t,n,a){var i=Object.assign({},this.state.allScens.filter(function(t){return t.id===e})[0]);i.modifReacts=Object(o.a)({},i.modifReacts),i.modifReacts[t]=[n,a];var c=this.state.allScens.map(function(e){return e.id===i.id?i:e});this.setState({allScens:c})}},{key:"removeModifReactionToScen",value:function(e,t){var n=Object.assign({},this.state.allScens.filter(function(t){return t.id===e})[0]);n.modifReacts=Object(o.a)({},n.modifReacts),delete n.modifReacts[t];var a=this.state.allScens.map(function(e){return e.id===n.id?n:e});this.setState({allScens:a})}},{key:"getModel",value:function(e){var t=this.state.allModels.filter(function(t){return t.id===e});return t.length>0?t[0]:null}},{key:"getScen",value:function(e){var t=this.state.allScens.filter(function(t){return t.id===e});return t.length>0?t[0]:null}},{key:"loadModel",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t in this.state.allModels){e.next=6;break}return e.next=3,ee(t,!0);case 3:n=e.sent,a=this.state.allModels.filter(function(e){return e.id!==t}).concat([n]),this.setState({allModels:a});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"switchMainPage",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n,a,i,c,r,o,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("options"!==this.state.page){e.next=34;break}this.setState({page:"results"}),t={},n=!0,a=!1,i=void 0,e.prev=6,c=this.state.allScens[Symbol.iterator]();case 8:if(n=(r=c.next()).done){e.next=17;break}return o=r.value,e.next=12,$(o);case 12:s=e.sent,t[o.id]=s;case 14:n=!0,e.next=8;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(6),a=!0,i=e.t0;case 23:e.prev=23,e.prev=24,n||null==c.return||c.return();case 26:if(e.prev=26,!a){e.next=29;break}throw i;case 29:return e.finish(26);case 30:return e.finish(23);case 31:this.setState({respfba:t}),e.next=35;break;case 34:this.setState({page:"options",respfba:{}});case 35:case"end":return e.stop()}},e,this,[[6,19,23,31],[24,,26,30]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=Object(o.a)({},this.state,{allModels:this.state.allModels,loadModel:this.loadModel.bind(this),setSelScenId:this.setSelScenId.bind(this),getSelScen:this.getSelScen.bind(this),addScen:this.addScen.bind(this),removeScen:this.removeScen.bind(this),getModel:this.getModel.bind(this),addModifReactionToScen:this.addModifReactionToScen.bind(this),removeModifReactionToScen:this.removeModifReactionToScen.bind(this),switchMainPage:this.switchMainPage.bind(this),getScen:this.getScen.bind(this),getReactionsIds:this.getReactionsIds.bind(this),getReactionFromId:this.getReactionFromId.bind(this),getMetaboliteIds:this.getMetaboliteIds.bind(this),getMetaboliteFromId:this.getMetaboliteFromId.bind(this),getMetaboliteBalance:this.getMetaboliteBalance.bind(this),setCreateNewScen:this.setCreateNewScen.bind(this),getObjectiveReaction:this.getObjectiveReaction.bind(this),getObjectiveReactionScen:this.getObjectiveReactionScen.bind(this),getReactions:this.getReactions.bind(this),getMetabolites:this.getMetabolites.bind(this)});return"options"===this.state.page?e=i.a.createElement("div",{id:"App"},i.a.createElement(H,null),i.a.createElement("div",{id:"App-content"},i.a.createElement(A,null),i.a.createElement(V,null))):"results"===this.state.page&&0===Object.keys(this.state.respfba).length?e=i.a.createElement("div",{id:"App"},i.a.createElement(H,null),i.a.createElement("div",{id:"loader"},i.a.createElement("div",{id:"loader-title"},"Running pFBA on models..."),i.a.createElement(oe.a,null))):"results"===this.state.page&&Object.keys(this.state.respfba).length===this.state.allScens.length&&(e=i.a.createElement("div",{id:"App"},i.a.createElement(H,null),i.a.createElement("div",{id:"App-content"},i.a.createElement("div",{id:"results-left"},i.a.createElement(ie,null),i.a.createElement(ce,null)),i.a.createElement(re,null)))),i.a.createElement(v.Provider,{value:t},e)}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},76:function(e,t,n){e.exports=n(101)},81:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},99:function(e,t,n){}},[[76,1,2]]]);
//# sourceMappingURL=main.527df1d3.chunk.js.map